<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mi Mini-Tienda</title>
<style>
body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
h1 { text-align: center; }
.topbar { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
.catalogo { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; }
.item { background: #fff; padding: 15px; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: relative; }
.item img { width: 100%; max-height: 180px; object-fit: contain; border-radius: 8px; }
.item video, .item iframe { width: 100%; max-height: 180px; margin-top: 5px; }
.item button { margin-top: 5px; padding: 8px; width: 100%; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; }
.edit-btn { background: #2196F3; margin-top: 5px; }
.delete-btn { background: #E53935; margin-top: 5px; }
#carrito, #pago, #admin { background: #fff; padding: 15px; margin-top: 20px; border-radius: 10px; }
input, select { margin: 5px 0; padding: 8px; width: 100%; }
.cantidad-box { display: flex; gap: 5px; align-items: center; }
.cantidad-box button { width: 30px; padding: 5px; }
.remove-btn { background: #d9534f; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; }
.publico-banner { background:#222; color:#fff; padding:10px; text-align:center; margin-bottom:20px; border-radius:8px; }
.carousel-btn { width: 30px; padding: 5px; margin-top:5px; background:#888; color:#fff; border:none; border-radius:5px; cursor:pointer; }

@media (max-width: 400px) {
  .item { padding: 10px; }
  .cantidad-box button { width: 25px; padding: 4px; }
}
</style>
</head>
<body>

<h1>Mi Mini-Tienda</h1>
<div id="bannerPublico"></div>

<div class="topbar">
  <button onclick="mostrarCatalogo()">Ver Catálogo</button>
  <button onclick="mostrarCarrito()">Carrito</button>
  <button onclick="mostrarAdmin()">Admin</button>
</div>

<div id="catalogo" class="catalogo"></div>
<div id="carrito"></div>
<div id="pago"></div>
<div id="admin">
  <h2>Agregar/Editar Producto</h2>
  <input type="text" id="nombre" placeholder="Nombre">
  <input type="number" id="precio" placeholder="Precio">
  <input type="text" id="imagen" placeholder="URL imagen">
  <input type="text" id="categoria" placeholder="Categoría">
  <input type="text" id="descripcion" placeholder="Descripción">
  <input type="text" id="origen" placeholder="Origen">
  <label><input type="checkbox" id="envioGratis"> Envío Gratis</label>
  <button onclick="agregarProducto()">Guardar Producto</button>
</div>

<script>
// Lista inicial de productos
let productos = [
  { nombre:"Playera Cuidado con el Perro", precio:250, imagen:"imagenes/playera.jpg", descripcion:"Playera original talla M", envioGratis:true, origen:"CDMX" },
  { nombre:"Jeans Azul", precio:400, imagen:"imagenes/jeans.jpg", descripcion:"Jeans original talla 32", envioGratis:false, origen:"Monterrey" }
];

let carrito = [];
let editIndex = null;

// Funciones de visualización
function mostrarCatalogo() {
  document.getElementById("catalogo").style.display="grid";
  document.getElementById("carrito").style.display="none";
  document.getElementById("admin").style.display="none";
  renderizarCatalogo();
}
function mostrarCarrito() {
  document.getElementById("catalogo").style.display="none";
  document.getElementById("carrito").style.display="block";
  document.getElementById("admin").style.display="none";
  renderizarCarrito();
}
function mostrarAdmin() {
  document.getElementById("catalogo").style.display="none";
  document.getElementById("carrito").style.display="none";
  document.getElementById("admin").style.display="block";
}

// Renderizar catálogo
function renderizarCatalogo() {
  const cont = document.getElementById("catalogo");
  cont.innerHTML = "";
  productos.forEach((p,index)=>{
    cont.innerHTML += `<div class="item">
      <img src="${p.imagen}" alt="${p.nombre}">
      <h3>${p.nombre}</h3>
      <p>${p.descripcion}</p>
      <p>Precio: $${p.precio}</p>
      <p>Origen: ${p.origen}</p>
      ${p.envioGratis? "<p style='color:green;'><b>¡Envío gratis!</b></p>":""}
      <button onclick="agregarAlCarrito(${index})">Agregar al carrito</button>
    </div>`;
  });
}

// Carrito
function agregarAlCarrito(index) {
  let producto = {...productos[index], cantidad:1};
  let existe = carrito.find(p=>p.nombre===producto.nombre);
  if(existe) { existe.cantidad +=1; } else { carrito.push(producto); }
  alert("Producto agregado al carrito");
}

function renderizarCarrito() {
  const cont = document.getElementById("carrito");
  cont.innerHTML = "<h2>Carrito</h2>";
  if(carrito.length===0){ cont.innerHTML += "<p>Carrito vacío</p>"; return; }
  let total = 0;
  carrito.forEach((p,index)=>{
    let sub = p.precio*p.cantidad; total+=sub;
    cont.innerHTML += `<li>${p.nombre} - $${p.precio} x ${p.cantidad} = $${sub}
      <div class='cantidad-box'>
        <button onclick="cambiarCantidad(${index}, '-')">-</button>
        <span>${p.cantidad}</span>
        <button onclick="cambiarCantidad(${index}, '+')">+</button>
        <button class='remove-btn' onclick="eliminarDelCarrito(${index})">X</button>
      </div>
    </li>`;
  });
  cont.innerHTML += `<p><b>Total: $<span id="total">${total}</span></b></p>`;
}

// Carrito helpers
function cambiarCantidad(index,op) {
  if(op==='-'){ carrito[index].cantidad-=1; if(carrito[index].cantidad<=0) carrito.splice(index,1); }
  else{ carrito[index].cantidad+=1; }
  renderizarCarrito();
}
function eliminarDelCarrito(index){ carrito.splice(index,1); renderizarCarrito(); }

// Admin
function agregarProducto() {
  const n=document.getElementById("nombre").value;
  const p=document.getElementById("precio").value;
  const img=document.getElementById("imagen").value;
  const cat=document.getElementById("categoria").value;
  const desc=document.getElementById("descripcion").value;
  const origen=document.getElementById("origen").value;
  const envio=document.getElementById("envioGratis").checked;
  if(!n||!p||!img||!cat) return alert("Completa todos los campos");
  if(editIndex!==null){
    productos[editIndex]={nombre:n,precio:Number(p),imagen:img,categoria:cat,descripcion:desc,envioGratis:envio,origen:origen};
    editIndex=null;
  } else {
    productos.push({nombre:n,precio:Number(p),imagen:img,categoria:cat,descripcion:desc,envioGratis:envio,origen:origen});
  }
  renderizarCatalogo();
  alert("Producto agregado/actualizado");
}

// Inicial
mostrarCatalogo();
</script>
</body>
</html>
